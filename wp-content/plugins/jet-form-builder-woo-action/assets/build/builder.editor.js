(()=>{"use strict";const e=window.wp.i18n,t="WC.CHECKOUT.COMPLETE",o="WC.ORDER.COMPLETE",{BaseComputedField:n}=JetFBComponents;function r(){n.call(this)}r.prototype=Object.create(n.prototype),r.prototype.isSupported=function(e){for(const n of[t,o])if(e?.events?.includes?.(n))return!0;return!1},r.prototype.getName=function(){return"_woocom_order_id"},r.prototype.getHelp=function(){return(0,e.sprintf)((0,e.__)("A computed field, which available at <b>(%1$s)</b> or <b>(%2$s)</b> event.","jet-form-builder-pdf"),t,o)};const l=r,a=window.jfb.actions,i=window.React,c=window.wp.element,d=window.wp.components,u=window.jfb.components,m=function({settings:t,onChangeSettingObj:o}){var n;const{hasError:r}=(0,a.useActionValidatorProvider)({isSupported:e=>"product_id_from"===e?.property});return(0,i.createElement)(u.RowControl,{createId:!1},(0,i.createElement)(u.RequiredLabel,null,(0,e.__)("Get product ID from","jet-form-builder-woo-action")),(0,i.createElement)(u.RowControlEnd,{hasError:r},(0,i.createElement)(d.__experimentalToggleGroupControl,{value:null!==(n=t.product_id_from)&&void 0!==n?n:"manual",onChange:e=>o({product_id_from:e}),hideLabelFromVision:!0,isBlock:!0,__nextHasNoMarginBottom:!0,__next40pxDefaultSize:!0},(0,i.createElement)(d.__experimentalToggleGroupControlOption,{label:(0,e.__)("Manual Input","jet-form-builder-woo-action"),value:"manual"}),(0,i.createElement)(d.__experimentalToggleGroupControlOption,{label:(0,e.__)("Form Field","jet-form-builder-woo-action"),value:"field"}))))},s=window.wp.compose,p=window.wp.coreData,_=function({settings:t,onChangeSettingObj:o}){var n,r;const{hasError:l}=(0,a.useActionValidatorProvider)({isSupported:e=>"product_manual"===e?.property}),[,c,m]=(0,s.useDebouncedInput)(""),_=(0,p.useEntityRecords)("postType","product",{per_page:20,search:m}),E=null!==(n=_.records?.map?.((e=>({value:e.id,label:e.title.raw}))))&&void 0!==n?n:[];return(0,i.createElement)(u.RowControl,{createId:!1},(0,i.createElement)(u.RequiredLabel,null,(0,e.__)("Select product","jet-form-builder-woo-action")),(0,i.createElement)(u.RowControlEnd,{hasError:l},(0,i.createElement)(d.ComboboxControl,{value:null!==(r=t?.product_manual?.[0]?.id)&&void 0!==r?r:"",options:E,onChange:e=>o({product_manual:[{id:e}]}),onFilterValueChange:c,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))},E=window.jfb.blocksToActions,f=function({settings:t,onChangeSettingObj:o}){const{hasError:n,setShowError:r}=(0,a.useActionValidatorProvider)({isSupported:e=>"product_id_field"===e?.property}),l=(0,E.useFields)({withInner:!1,placeholder:"--"});return(0,i.createElement)(u.RowControl,null,(({id:a})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.RequiredLabel,{htmlFor:a},(0,e.__)("Product ID field","jet-form-builder-woo-action")),(0,i.createElement)(u.RowControlEnd,{hasError:n},(0,i.createElement)(d.SelectControl,{id:a,value:t.product_id_field,onChange:e=>o({product_id_field:e}),options:l,onBlur:()=>r(!0),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))))},g=function({settings:t,onChangeSettingObj:o}){const n=(0,E.useFields)({withInner:!1,placeholder:"--"});return(0,i.createElement)(u.RowControl,null,(({id:r})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.Label,{htmlFor:r},(0,e.__)("WooCommerce Price field","jet-form-builder-woo-action")),(0,i.createElement)(u.RowControlEnd,null,(0,i.createElement)(d.SelectControl,{id:r,value:t.wc_price,onChange:e=>o({wc_price:e}),options:n,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}),(0,i.createElement)(u.Help,null,(0,e.__)("Select field to get total price from. If not selected price will be get from post meta value.","jet-form-builder-woo-action"))))))},w=function({settings:t,onChangeSettingObj:o}){return(0,i.createElement)(u.RowControl,null,(({id:n})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.Label,{htmlFor:n},(0,e.__)("Heading for Order Details","jet-form-builder-woo-action")),(0,i.createElement)(d.TextControl,{id:n,value:t.wc_heading_order_details,onChange:e=>o({wc_heading_order_details:e}),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0}))))},C=window.wp.data,{RepeaterItemContext:b}=JetFBComponents,h=function({formFields:t}){const{currentItem:o,changeCurrentItem:n}=(0,c.useContext)(b);return(0,i.createElement)(d.Flex,{direction:"column"},(0,i.createElement)(u.RowControl,null,(({id:t})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.Label,{htmlFor:t},(0,e.__)("Label","jet-form-builder-woo-action")),(0,i.createElement)(d.TextControl,{id:t,value:o.label,onChange:e=>n({label:e}),__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))),(0,i.createElement)(u.WideLine,null),(0,i.createElement)(u.RowControl,null,(({id:r})=>(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.Label,{htmlFor:r},(0,e.__)("Select form field","jet-form-builder-woo-action")),(0,i.createElement)(d.SelectControl,{id:r,value:o.field,onChange:e=>n({field:e}),options:t,__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0})))))},{Repeater:S,RepeaterAddNew:j,RepeaterState:x}=JetFBComponents,v=function({setIsShow:t}){const[o,n]=(0,c.useState)(!1),[r,l]=(0,c.useState)((()=>JetActionWooCheckout.details)),a=(0,E.useFields)({withInner:!1,placeholder:"--"}),m=(0,C.useSelect)((e=>e("core/editor").getEditedPostAttribute("id")),[]);return(0,i.createElement)(d.Modal,{size:"large",title:(0,e.__)("Set up WooCommerce order details","jet-form-builder-woo-action"),onRequestClose:()=>t(!1),className:u.ModalFooterStyle},(0,i.createElement)(x,{state:e=>{l(e(r))}},(0,i.createElement)(S,{items:r},(0,i.createElement)(h,{formFields:a})),(0,i.createElement)(j,null,(0,e.__)("Add New Item","jet-form-builder-woo-action"))),(0,i.createElement)("div",{style:{width:"100%",height:"1em"}}),(0,i.createElement)(u.StickyModalActions,null,(0,i.createElement)(d.Button,{isPrimary:!0,onClick:function(){n(!0),jQuery.ajax({url:window.ajaxurl,type:"POST",dataType:"json",data:{action:"jet_fb_woo_save_details",post_id:m,nonce:JetActionWooCheckout.nonce,details:r}}).done((function(e){e.success?(JetActionWooCheckout.details=r,t(!1)):alert(e.data.message)})).fail((function(e,t,o){alert(o)})).always((()=>{n(!1)}))},disabled:o,isBusy:o},(0,e.__)("Update","jet-form-builder-woo-action")),(0,i.createElement)(d.Button,{isSecondary:!0,disabled:o,onClick:()=>t(!1)},(0,e.__)("Cancel","jet-form-builder-woo-action"))))},F=function({settings:t,onChangeSettingObj:o}){const n=(0,E.useFields)({withInner:!1,placeholder:"--"});return(0,i.createElement)(u.RowControl,{createId:!1},(0,i.createElement)(u.Label,null,(0,e.__)("WooCommerce checkout fields map","jet-form-builder-woo-action")),(0,i.createElement)(u.RowControlEnd,{gap:4},(0,i.createElement)(u.Help,null,(0,e.__)("Connect WooCommerce checkout fields to appropriate form fields. This allows you to pre-fill WooCommerce checkout fields after redirect to checkout.","jet-form-builder")),JetActionWooCheckout.wc_fields.map((e=>(0,i.createElement)(a.FieldsMapField,{key:e.value,tag:e.value,label:e.label,isRequired:e.required,formFields:n,value:t[`wc_fields_map__${e.value}`],onChange:t=>o({[`wc_fields_map__${e.value}`]:t})})))))},y={type:"redirect_to_woo_checkout",edit:function({settings:t,onChangeSettingObj:o}){const[n,r]=(0,c.useState)(!1);return(0,i.createElement)(d.Flex,{direction:"column"},(0,i.createElement)(d.Notice,{status:"info",isDismissible:!1},(0,i.createElement)(d.Icon,{icon:"info-outline",style:{marginRight:"8px",color:"#007cba"}}),(0,e.__)("The `Redirect to Page` action can't use the `WC.ORDER.COMPLETE` and `WC.CHECKOUT.COMPLETE` events.","jet-form-builder-woo-action")),(0,i.createElement)(m,{settings:t,onChangeSettingObj:o}),"manual"===(t?.product_id_from||"manual")&&(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.WideLine,null),(0,i.createElement)(_,{settings:t,onChangeSettingObj:o})),"field"===t.product_id_from&&(0,i.createElement)(i.Fragment,null,(0,i.createElement)(u.WideLine,null),(0,i.createElement)(f,{settings:t,onChangeSettingObj:o})),(0,i.createElement)(u.WideLine,null),(0,i.createElement)(g,{settings:t,onChangeSettingObj:o}),(0,i.createElement)(u.WideLine,null),(0,i.createElement)(w,{settings:t,onChangeSettingObj:o}),(0,i.createElement)(u.WideLine,null),(0,i.createElement)(u.RowControl,{createId:!1},(0,i.createElement)(u.Label,null,(0,e.__)("WooCommerce order details","jet-form-builder-woo-action")),(0,i.createElement)(u.RowControlEnd,null,(0,i.createElement)(d.FlexItem,null,(0,i.createElement)(d.Button,{variant:"secondary",onClick:()=>r(!0)},(0,e.__)("Set up","jet-form-builder-woo-action"))),(0,i.createElement)(u.Help,null,(0,e.__)("Set up info you want to add to the WooCommerce orders and e-mails","jet-form-builder-woo-action")))),(0,i.createElement)(u.WideLine,null),(0,i.createElement)(F,{settings:t,onChangeSettingObj:o}),n&&(0,i.createElement)(v,{setIsShow:r}))},provideEvents:()=>[t,o],disabled:!1,docHref:"https://jetformbuilder.com/addons/woocommerce-cart-checkout-action/",validators:[({settings:e})=>"manual"===(e?.product_id_from||"manual")&&!e?.product_manual?.length&&{type:"empty",property:"product_manual"},({settings:e})=>"field"===e?.product_id_from&&!e?.product_id_field&&{type:"empty",property:"product_id_field"}]};(0,a.registerAction)(y),(0,a.addComputedField)(l,{isScoped:!0})})();